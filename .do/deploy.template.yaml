spec:
  name: ardent-pos
  services:
  - name: backend
    source_dir: /backend
    github:
      repo: mdYoungDOer/ardent-pos
      branch: main
    build_command: composer install --no-dev --optimize-autoloader
    run_command: vendor/bin/heroku-php-apache2
    environment_slug: php
    instance_count: 1
    instance_size_slug: basic-xxs
    http_port: 8080
    routes:
    - path: /api
    envs:
    - key: DB_HOST
      scope: RUN_TIME
      type: SECRET
    - key: DB_PORT
      scope: RUN_TIME
      value: "25060"
    - key: DB_NAME
      scope: RUN_TIME
      value: "ardent_pos"
    - key: DB_USER
      scope: RUN_TIME
      type: SECRET
    - key: DB_PASS
      scope: RUN_TIME
      type: SECRET
    - key: JWT_SECRET
      scope: RUN_TIME
      type: SECRET

  - name: frontend
    source_dir: /frontend
    github:
      repo: mdYoungDOer/ardent-pos
      branch: main
    build_command: npm ci && npm run build
    environment_slug: node-js
    instance_count: 1
    instance_size_slug: basic-xxs
    routes:
    - path: /
    envs:
    - key: REACT_APP_API_URL
      scope: BUILD_TIME
      value: "${backend.PUBLIC_URL}"

  databases:
  - engine: PG
    name: ardent-pos-db
    num_nodes: 1
    size: db-s-1vcpu-1gb
    version: "14"
